#!/usr/bin/ruby
#coding:utf-8

=begin
N=2 => 1
N=3 => 11
N=4 => 19
N=5 => 29
N=6 => 37
=end

N=6
#left,center,right
DEST=[[nil,N,N+1]]+
	1.step(N-2).map{|i|[N+i-1,N+i,N+i+1]}+
	[[N-1+N-1,N-1+N,nil]]+
	[[nil,0,1]]+
	(N+1).step(N-2+N).map{|i|[i-1-N,i-N,i+1-N]}+
	[[N-2,N-1,nil]]

START=[*0..N-2+N]+[nil]
GOAL=[nil]+[*1..N-2+N]+[0]

queue=[START]
back={START=>START}
while !queue.empty?
	cur=queue.shift
	nxt=cur.dup
	idx=cur.index(nil)
	DEST[idx].each{|e|
		next if !e
		nxt[e],nxt[idx]=nxt[idx],nxt[e]
		if !back[nxt]
			back[nxt.dup]=cur
			queue<<nxt.dup
			if nxt==GOAL
				cnt=0
				while nxt!=START
					p nxt[0,N]
					p nxt[N,N]
					nxt=back[nxt]
					cnt+=1
				end
				p nxt[0,N]
				p nxt[N,N]
				p cnt
				exit
			end
		end
		nxt[e],nxt[idx]=nxt[idx],nxt[e]
	}
end

__END__
[nil, 1, 2, 3, 4, 5]
[6, 7, 8, 9, 10, 0]
[6, 1, 2, 3, 4, 5]
[nil, 7, 8, 9, 10, 0]
[6, nil, 2, 3, 4, 5]
[1, 7, 8, 9, 10, 0]
[6, 8, 2, 3, 4, 5]
[1, 7, nil, 9, 10, 0]
[6, 8, 2, nil, 4, 5]
[1, 7, 3, 9, 10, 0]
[6, 8, 2, 9, 4, 5]
[1, 7, 3, nil, 10, 0]
[6, 8, 2, 9, nil, 5]
[1, 7, 3, 4, 10, 0]
[6, 8, 2, 9, 0, 5]
[1, 7, 3, 4, 10, nil]
[6, 8, 2, 9, 0, nil]
[1, 7, 3, 4, 10, 5]
[6, 8, 2, 9, 0, 10]
[1, 7, 3, 4, nil, 5]
[6, 8, 2, nil, 0, 10]
[1, 7, 3, 4, 9, 5]
[6, 8, 2, 4, 0, 10]
[1, 7, 3, nil, 9, 5]
[6, 8, 2, 4, nil, 10]
[1, 7, 3, 0, 9, 5]
[6, 8, 2, 4, 9, 10]
[1, 7, 3, 0, nil, 5]
[6, 8, 2, nil, 9, 10]
[1, 7, 3, 0, 4, 5]
[6, 8, 2, 3, 9, 10]
[1, 7, nil, 0, 4, 5]
[6, nil, 2, 3, 9, 10]
[1, 7, 8, 0, 4, 5]
[6, 7, 2, 3, 9, 10]
[1, nil, 8, 0, 4, 5]
[6, 7, nil, 3, 9, 10]
[1, 2, 8, 0, 4, 5]
[6, 7, 0, 3, 9, 10]
[1, 2, 8, nil, 4, 5]
[6, 7, 0, 3, nil, 10]
[1, 2, 8, 9, 4, 5]
[6, 7, 0, 3, 4, 10]
[1, 2, 8, 9, nil, 5]
[6, 7, 0, nil, 4, 10]
[1, 2, 8, 9, 3, 5]
[6, 7, 0, 8, 4, 10]
[1, 2, nil, 9, 3, 5]
[6, nil, 0, 8, 4, 10]
[1, 2, 7, 9, 3, 5]
[6, 2, 0, 8, 4, 10]
[1, nil, 7, 9, 3, 5]
[6, 2, nil, 8, 4, 10]
[1, 0, 7, 9, 3, 5]
[6, 2, 7, 8, 4, 10]
[1, 0, nil, 9, 3, 5]
[6, nil, 7, 8, 4, 10]
[1, 0, 2, 9, 3, 5]
[6, 1, 7, 8, 4, 10]
[nil, 0, 2, 9, 3, 5]
[nil, 1, 7, 8, 4, 10]
[6, 0, 2, 9, 3, 5]
[0, 1, 7, 8, 4, 10]
[6, nil, 2, 9, 3, 5]
[0, 1, nil, 8, 4, 10]
[6, 7, 2, 9, 3, 5]
[0, 1, 2, 8, 4, 10]
[6, 7, nil, 9, 3, 5]
[0, 1, 2, nil, 4, 10]
[6, 7, 8, 9, 3, 5]
[0, 1, 2, 3, 4, 10]
[6, 7, 8, 9, nil, 5]
[0, 1, 2, 3, 4, nil]
[6, 7, 8, 9, 10, 5]
[0, 1, 2, 3, 4, 5]
[6, 7, 8, 9, 10, nil]
37

real	6m49.294s
user	6m41.738s
sys	0m4.136s